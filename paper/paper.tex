% This project is part of the Tensor Estimator project
% Copyright 2018 the authors.

% to-do
% -----
% - get yourself an ORCID and use it.
% - Is ``vectorized'' the right word? It's what I say, but now I'm doubting it. We could go with linear-regression. Or affine-invariant. Or unbinned. Or continuous-function?

% style notes
% -----------
% - line break at sentence breaks? Or more frequently? So git diff works good?

\documentclass[modern]{aastex62}

% aastex parameters
%%\hypersetup{linkcolor=red,citecolor=green,filecolor=cyan,urlcolor=magenta}
\received{not yet but hopefully soon!!}
%\revised{not yet}
%\accepted{not yet}
%\submitjournal{ApJ}
\shorttitle{vectorized correlation function estimator}
\shortauthors{storey-fisher and hogg}

% typography

% affiliations
\newcommand{\ccpp}{\affiliation{%
    Center for Cosmology and Particle Physics,
    Department of Physics,
    New York University}}
\newcommand{\flatiron}{\affiliation{%
    Flatiron Institute, Simons Foundation}}
\newcommand{\cds}{\affiliation{%
    Center for Data Science,
    New York University}}
\newcommand{\mpia}{\affiliation{%
    Max-Planck-Institut f\"{u}r Astronomie, Heidelberg}}

\begin{document}\sloppy\sloppypar\raggedbottom\frenchspacing

\title{A Vectorized Correlation Function Estimator For Large-Scale Structure}
%\title{A Generalized Correlation Function Estimator for Galaxy Surveys}

%Tensorial estimator?
%Generalized estimator?
%Tensorial estimator? 
%Projected estimator?
%Continuous estimator?
%Vecstimator?


\author{Kate Storey-Fisher}
\ccpp

\author[0000-0003-2866-9403]{David W. Hogg}
\ccpp
\cds
\mpia
\flatiron

\begin{abstract}\noindent
% Context
The two-point correlation function (2PCF) the most important statistic in structure formation.
However, current estimators of the 2PCF have significant limitations.
The standard Landy-Szalay (LS) estimator evaluates the 2PCF in bins of radial separation between objects, and the choice of bins introduces a trade-off between bias and variance.
Further trade-offs are required to determine the dependence of clustering on galaxy properties or redshift, typically by subsampling the objects.
% Aims
We present a new, vectorized estimator (Foo) for the 2PCF that obviates binning in separation or anything else.
Instead of estimating the 2PCF in bins, it estimates the parameters of a continuous-function representation of the 2PCF in the form of a linear superposition of basis functions.
% Methods
Inspired by linear least-squares fitting, the Foo estimator marks the numerator terms of LS with vectors of basis functions of pair properties, and the denominator with a tensor of outer products of those functions.
The function estimates the best-fit linear combination of basis functions to describe the 2PCF, in the limit that LS would be applicable.
% Results
We apply Foo to artificial data to demonstrate that it can determine the clustering in a representation that provides more accuracy with fewer basis functions than LS, thus reducing requirements on mocks for covariance estimation.
We apply Foo to the Main Sample of the Sloan Digital Sky Survey (SDSS) to show that Foo can measure the luminosity-dependence of clustering without binning samples in luminosity.
We apply Foo to the Luminous Red Galaxy Sample of SDSS-III (DO WE?) to show that Foo can extract a small set of Fisher-optimal statistics for measuring the location of the Baryon Acoustic Feature.
We discuss other applications and limitations of Foo for present and future studies of large-scale structure; in principle it can be used to unify real-space and Fourier-space approaches.
\end{abstract}



\section{Introduction}

Large-scale structure (LSS) is well-described by $\Lambda$CDM. 

LSS is also used to constrain galaxy formation.

The Landy-Szalay estimator is traditionally used to characterize clustering in the LSS.

The marked correlation function has been used to understand the clustering dependence on galaxy properties.

The 2PCF is closely related to the power spectrum, but these are computed separately. 

This is a probabilistic/frequentist approach.

\section{Generalities}

The Landy-Szalay estimator is justified by\ldots

Estimating clustering is closely related to least-squares fitting.

From these, we can infer the form of the estimator.

\section{Methods}

We derive/define this new estimator.

We show that it reduces to the Landy-Szalay estimator.

We prove that the estimator is invariant under affine transformations.

These show that the estimator is correct.

We implement this estimator using \ldots

\section{Tests and Results}

To test this estimator, we generate a Gaussian random field with a known power spectrum (and thus known correlation function). We sample the field to obtain a set of tracer objects.

We apply the estimator to the SDSS main galaxy sample. \ldots We reproduce the results of Zehavi et al, showing that the clustering shows a strong dependence on luminosity. \ldots We find that we can more precisely track this luminosity evolution.

We use this estimator to linearize around the BAO feature, using an LRG dataset. Show Fisher-optimal! (Different Fisher.)

\section{Discussion}

Covariance matrix

We estimated the 2PCF with fewer components to achieve the same level of detail.

In the future, we could simultaneously estimate the correlation function and the power spectrum.

We could also investigate: gradients, anomalies, growth of structure, directly estimating the cosmological parameters, calibrating for systematics

We have reformulated the correlation function in terms of pairs of objects.

Our performance is by definition the same as traditional estimators due to the limiting factor of pair-finding.

Use our estimator it is the best!

\acknowledgements
It is a pleasure to thank\ldots

\end{document}
